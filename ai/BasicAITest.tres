[gd_resource type="BehaviorTree" load_steps=36 format=3 uid="uid://dkac84hk3df7m"]

[ext_resource type="BehaviorTree" uid="uid://1jmgxtdc78wt" path="res://ai/Template Behaviors/Roam.tres" id="1_fr7y0"]
[ext_resource type="BehaviorTree" uid="uid://bnxffngabpoio" path="res://ai/Template Behaviors/Idle.tres" id="2_770u8"]
[ext_resource type="Script" uid="uid://c0lwcjpga1mjd" path="res://ai/tasks/Utility_Custom/AwaitVarTime.cs" id="3_770u8"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_dmoef"]
var/Await_var/name = &"Await_var"
var/Await_var/type = 3
var/Await_var/value = 0.0
var/Await_var/hint = 0
var/Await_var/hint_string = "how many ticks the BT should wait"
var/Parent_var/name = &"Parent_var"
var/Parent_var/type = 22
var/Parent_var/value = NodePath(".")
var/Parent_var/hint = 0
var/Parent_var/hint_string = "The parent that controls the BT"
var/PlayerInRange_var/name = &"PlayerInRange_var"
var/PlayerInRange_var/type = 1
var/PlayerInRange_var/value = false
var/PlayerInRange_var/hint = 0
var/PlayerInRange_var/hint_string = ""
var/PlayerAgro_var/name = &"PlayerAgro_var"
var/PlayerAgro_var/type = 1
var/PlayerAgro_var/value = false
var/PlayerAgro_var/hint = 0
var/PlayerAgro_var/hint_string = ""
var/IsServer_var/name = &"IsServer_var"
var/IsServer_var/type = 1
var/IsServer_var/value = false
var/IsServer_var/hint = 0
var/IsServer_var/hint_string = ""
var/WhatAreWeDoing_var/name = &"WhatAreWeDoing_var"
var/WhatAreWeDoing_var/type = 3
var/WhatAreWeDoing_var/value = 0.0
var/WhatAreWeDoing_var/hint = 0
var/WhatAreWeDoing_var/hint_string = ""

[sub_resource type="BTWait" id="BTWait_fr7y0"]
duration = 0.5

[sub_resource type="BBNode" id="BBNode_mkpdr"]
resource_name = "."
saved_value = NodePath(".")

[sub_resource type="BTCallMethod" id="BTCallMethod_vesqq"]
node = SubResource("BBNode_mkpdr")
method = &"IsServer"
result_var = &"IsServer_var"

[sub_resource type="BBVariant" id="BBVariant_fr7y0"]
resource_name = "true"
saved_value = true
type = 1

[sub_resource type="BTCheckVar" id="BTCheckVar_770u8"]
variable = &"IsServer_var"
value = SubResource("BBVariant_fr7y0")

[sub_resource type="BTDynamicSequence" id="BTDynamicSequence_lw8pa"]
children = [SubResource("BTCallMethod_vesqq"), SubResource("BTCheckVar_770u8")]

[sub_resource type="BBNode" id="BBNode_fr7y0"]
resource_name = "."
saved_value = NodePath(".")

[sub_resource type="BTCallMethod" id="BTCallMethod_770u8"]
custom_name = "CheckPlayersInRange - Bool: PlayerInRange_var"
node = SubResource("BBNode_fr7y0")
method = &"CheckPlayersInRange"
result_var = &"PlayerInRange_var"

[sub_resource type="BTComment" id="BTComment_fr7y0"]
custom_name = "This will check if the player is in range, if the player isn't it will return sucess and not run the probability selector"

[sub_resource type="BBVariant" id="BBVariant_mkpdr"]
resource_name = "false"
saved_value = false
type = 1

[sub_resource type="BTCheckVar" id="BTCheckVar_vesqq"]
_enabled = false
variable = &"PlayerInRange_var"
value = SubResource("BBVariant_mkpdr")

[sub_resource type="BTSequence" id="BTSequence_lw8pa"]
custom_name = "Check Player In Range"
children = [SubResource("BTCallMethod_770u8"), SubResource("BTComment_fr7y0"), SubResource("BTCheckVar_vesqq")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_fr7y0"]
children = [SubResource("BTSequence_lw8pa")]

[sub_resource type="BBNode" id="BBNode_770u8"]
resource_name = "."
saved_value = NodePath(".")

[sub_resource type="BTCallMethod" id="BTCallMethod_mkpdr"]
custom_name = "CheckAgro - Bool: PlayerAgro_var"
node = SubResource("BBNode_770u8")
method = &"CheckAgro"
result_var = &"PlayerAgro_var"

[sub_resource type="BBVariant" id="BBVariant_vesqq"]
resource_name = "false"
saved_value = false
type = 1

[sub_resource type="BTCheckVar" id="BTCheckVar_lw8pa"]
_enabled = false
variable = &"PlayerAgro_var"
value = SubResource("BBVariant_vesqq")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_mkpdr"]

[sub_resource type="BTSubtree" id="BTSubtree_vesqq"]
custom_name = "Roam"
blackboard_plan = SubResource("BlackboardPlan_mkpdr")
subtree = ExtResource("1_fr7y0")
metadata/_weight_ = 3.0

[sub_resource type="BlackboardPlan" id="BlackboardPlan_lw8pa"]

[sub_resource type="BTSubtree" id="BTSubtree_hbr04"]
custom_name = "Idle"
blackboard_plan = SubResource("BlackboardPlan_lw8pa")
subtree = ExtResource("2_770u8")

[sub_resource type="BTProbabilitySelector" id="BTProbabilitySelector_770u8"]
custom_name = "Random Movement If player not agro"
children = [SubResource("BTSubtree_vesqq"), SubResource("BTSubtree_hbr04")]

[sub_resource type="BTSequence" id="BTSequence_hbr04"]
custom_name = "Non Agro moves"
children = [SubResource("BTCallMethod_mkpdr"), SubResource("BTCheckVar_lw8pa"), SubResource("BTProbabilitySelector_770u8")]

[sub_resource type="BBNode" id="BBNode_vesqq"]
resource_name = "."
saved_value = NodePath(".")

[sub_resource type="BTCallMethod" id="BTCallMethod_lw8pa"]
node = SubResource("BBNode_vesqq")
method = &"WhatAreWeDoing"
result_var = &"WhatAreWeDoing_var"

[sub_resource type="BBFloat" id="BBFloat_mkpdr"]
resource_name = "$WhatAreWeDoing_var"
value_source = 1
variable = &"WhatAreWeDoing_var"

[sub_resource type="BTAction" id="BTAction_vesqq"]
script = ExtResource("3_770u8")
AwaitVar = SubResource("BBFloat_mkpdr")

[sub_resource type="BTSequence" id="BTSequence_yu8hw"]
children = [SubResource("BTCallMethod_lw8pa"), SubResource("BTAction_vesqq")]

[sub_resource type="BTDynamicSelector" id="BTDynamicSelector_hbr04"]
children = [SubResource("BTAlwaysFail_fr7y0"), SubResource("BTSequence_hbr04"), SubResource("BTSequence_yu8hw")]

[sub_resource type="BTRepeat" id="BTRepeat_41nhw"]
children = [SubResource("BTDynamicSelector_hbr04")]
forever = true

[sub_resource type="BTSequence" id="BTSequence_g8bpm"]
children = [SubResource("BTWait_fr7y0"), SubResource("BTDynamicSequence_lw8pa"), SubResource("BTRepeat_41nhw")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_dmoef")
root_task = SubResource("BTSequence_g8bpm")
